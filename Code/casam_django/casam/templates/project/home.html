
{% extends 'base.html' %}
{% block title %}Overzicht projecten en foto's{% endblock title %}

{% block head %}
  <link href="{{ BASE_PATH }}media/css/whiteFrame.css" rel="stylesheet" type="text/css" media="screen" />
  <link href="{{ BASE_PATH }}media/css/projectHome.css" rel="stylesheet" type="text/css" media="screen" />
	<script src="{{ BASE_PATH }}media/js/ajax.js" type="text/javascript"></script>
	<script src="{{ BASE_PATH }}media/js/getmouse.js" type="text/javascript"></script>
	<script src="{{ BASE_PATH }}media/js/images.js" type="text/javascript"></script>
	<script src="{{ BASE_PATH }}media/js/landmarks.js" type="text/javascript"></script>
  <script src="{{ BASE_PATH }}media/js/casamcustom.js" type="text/javascript"></script>
  <script type="text/javascript">
    var base_path = "{{ BASE_PATH }}";

	  var AddedImage = Class.create({
		  initialize: function(id,name) {
		    this.id = id;
		    this.name = name;
		    this.opacity = 0.5;
		    this.imageElement = new Element('img');
		    this.imageElement.writeAttribute('src',this.getAppropriateSizeURL());
		    this.imageElement.writeAttribute('id','addedImage_'+id);
		    this.imageElement.writeAttribute('class','big_image_sibling');
		    this.imageElement.setOpacity(this.opacity);

		    
		    this.opacitySliderContainer = new Element('div');
				//HARDCODE THIS WIDTH FOR THE SLIDER TO WORK INITIALLY
		    this.opacitySliderContainer.setWidth(170);
		    this.opacitySliderContainer.writeAttribute('id','opacitySliderContainer_'+this.id);
		    this.opacitySliderContainer.writeAttribute('class','slider');
		    
		    this.opacitySliderHandle = new Element('div');
		    this.opacitySliderHandle.writeAttribute('id','opacitySliderHandle_'+this.id);
		    this.opacitySliderHandle.writeAttribute('class','handle');
		    
		    this.opacitySliderContainer.insert(this.opacitySliderHandle);
		    
		  },
	  	getAppropriateSizeURL: function(){
			  return ('{{BASE_PATH}}imageLoader/byMaxWidthHeight/'+($('big_images').getWidth()-2)+'/'+($('big_images').getHeight()-2)+'/'+this.id);
		  },
		  getImageElement: function(){
			  return this.imageElement;
		  },
		  getOpacitySliderContainer: function(){
				return this.opacitySliderContainer;
		  },
		  setOpacityForImage: function(opacityValue){
				this.opacity = opacityValue;
			  this.imageElement.setOpacity(this.opacity);
		  },
		  addSelfToImages:function(){
				var parentAddedImageObject = this;
			  this.imageElement.writeAttribute('src',this.getAppropriateSizeURL());
				$('big_images').insert({'bottom':this.getImageElement()});
				this.getImageElement().observe('click',function(){
          LoadMMDD('',parentAddedImageObject.id);
				});
				
				$('bottomDiv'+parentAddedImageObject.id).insert(this.getOpacitySliderContainer());
			  new Control.Slider(this.opacitySliderHandle,this.opacitySliderContainer, {
				  minimum: 0,
				  maximum: 1,
				  sliderValue: parentAddedImageObject.opacity,
					onSlide: function(value){
				  	parentAddedImageObject.setOpacityForImage(value);
			  	}
			  });

			  var deleteButton = new Element('img',{'src':'{{BASE_PATH}}media/img/delete.png'});
			  deleteButton.addClassName('imageDeleteButton');
			  Element.observe(deleteButton, 'click', function(){
				  hideImage(parentAddedImageObject.id);
			  });
			  $('bottomDiv'+parentAddedImageObject.id).insert(deleteButton);
        
        getImageMeasurements(parentAddedImageObject.id)
		  }
		  
		});

		var addedImages = new Array();
		
    var total_images = 0;
    
    
    var Measurement = Class.create({
		  initialize: function(id,potid,name,imageid,pin) {
		    this.id = id;
		    this.potid = potid;
        this.name = name;
        this.imageid = imageid;
        this.pinDiv = pin;
        this.left = 0;
        this.top = 0;
        this.drag = null;
		  },
      setPlace:function(x,y){
        this.left = x;
        this.top = y;
      },
      place:function(){
        this.pinDiv.setStyle('position: absolute; left: '+this.left+'px;top: '+this.top+'px;');
        this.pinDiv.show();
      },
      restore:function(){
        this.pinDiv.hide();
      },
      changeColor:function(color){
        this.pinDiv.childElements()[0].src = "{{BASE_PATH}}media/img/pin_"+color+".gif";
      },
      setActive:function(){
        this.changeColor('red');
        this.drag = makeDraggable(this.pinDiv,this.potid,this.imageid);
      },
      nonActive:function(){
        this.changeColor('green');
        if(this.drag != null)
          this.drag.destroy();
      }
      });
		function makeDraggable(pinDiv,potid,imageid){
      return new Draggable(pinDiv, { onDrag: function(element,event) { pinDiv.childElements()[1].hide(); }, onEnd: function() {
                        LoadMMDD(potid,imageid); 
							         }
						        });
    }
		var measurements = new Array();
		
	  document.observe("dom:loaded", function()
		{
      // Add tabs in whiteFrame
      $('leftFrame_content').insert(newTab('Project information', $('tab_projectinfo'), true));
      $('leftFrame_content').insert(newTab('Pictures', $('tab_pictures'), true));
      $('leftFrame_content').insert(newTab('Papers', $('tab_papers'), false));
      
      $('rightFrame_content').insert(newTab('Possible measurements', $('tab_measurements'), true));
      $('rightFrame_content').insert(newTab('Transparency', $('tab_attributes'), false));

		  // Add mouse listener for image
      Event.observe('big_images','mousemove', getMouseXY);

			// Load images
			getProjectImages();

			// Load tags
			getProjectTags();

			// Load potential measurements
			getProjectPotentialMeasurements();
			 
			
			// Make draggable's for each Measurement

			new Draggable('lmdd');

			resizeScreenElements();
			Event.observe(window,'resize',function(){
				resizeScreenElements();
			});
			Event.observe('editTagsLink','click',function(){
				popupIFrame('{{ BASE_PATH }}tag/select/{{ id }}',350,150);
			});
			Event.observe('addMeasurementLink','click',function(){
        popupIFrame('{{ BASE_PATH }}pm/new/{{ id }}',350,150);
      });
		});

    function getImageMeasurements(imgid){
    
      var url = '{{ BASE_PATH }}JSON/projectImageCurrentMeasurements/'+imgid+'?time='+new Date().getTime();
      new Ajax.Request(url, {
        method: 'get',
        onSuccess: function(transport, json) {
          var json = transport.responseText.evalJSON();
          var mainDiv = new Element('div');
          mainDiv.addClassName('projectPictureDiv');
          
          
          var viewportOffset = $('big_images').viewportOffset();
          
          for(var i=0; i < measurements.length; i++){
            if(measurements[i].imageid == imgid){
              measurements[i].restore();
              measurements.splice(i,1);
              //splice shifts the index of the array 1 to the left, so compensate
              i = i-1;
            }
          }
          
          var imgname = '';
          for(var j = 0; j < addedImages.length; j++){
            if(addedImages[j].id == imgid){
              imgname = addedImages[j].name;
              break;
            }
          }
          for(i=0; i < json.length-1; i=i+2){
            
            var pinDiv = new Element('div');
            pinDiv.setStyle('display: none;');
            
            var pin = new Element('img',{'src':'{{BASE_PATH}}media/img/pin_green.gif'});
            var pintooltip = new Element('div').update(json[i].fields.name+'<br />'+imgname+'<br />'+json[i+1].fields.x+', '+json[i+1].fields.y);
            pintooltip.addClassName('pintooltip');
            pintooltip.setStyle('display: none;');

            pin.observe('mouseover', showLandmarkTooltip);
            pin.observe('mouseout', hideLandmarkTooltip);
            
            pinDiv.insert(pin);
            pinDiv.insert(pintooltip);
            $('big_images').insert(pinDiv);
            
            var measurement = new Measurement(json[i+1].pk,json[i].pk,json[i].fields.name,imgid,pinDiv);
            var measurementDiv = new Element('div');
            measurementDiv.addClassName('projectImageMeasurementDiv');
            checkbox = new Element('input', {'type': 'checkbox','name':json[i+1].pk});
            //when called insert, IE defaults his checkboxes to the default value (which is false).
            //so set the default to true
            checkbox.defaultChecked = true;
            checkbox.observe('click', function(){
              var thismeasurement = '';
              for(var i=0; i < measurements.length; i++){
                if (measurements[i].id == this.name){
                  thismeasurement = measurements[i];
                  break;                  
                }
              }
              if(this.checked == true){
                thismeasurement.place();          
              }
              else{
                thismeasurement.restore();
              }
            });
            textspan = new Element('span');
            textspan.update(json[i].fields.name+' ('+json[i+1].fields.x+', '+json[i+1].fields.y+')')
            measurementDiv.insert(checkbox);
            measurementDiv.insert(textspan);
            
            //load the measurements the first time
            measurement.setPlace(json[i+1].fields.x,json[i+1].fields.y);
            measurement.place();
            
            if(addedImages[0].id == imgid)
              measurement.setActive();
            else
              measurement.nonActive();
              
            measurements.push(measurement);
            mainDiv.insert(measurementDiv);
          }
          
          if ($('bottomDiv'+imgid).childElements().length == 3)
            $('bottomDiv'+imgid).childElements()[2].innerHTML = mainDiv.innerHTML;
          else
            $('bottomDiv'+imgid).insert(mainDiv);  
        }  
      });                                      
    }

       
		function resizeScreenElements()
		{
			var remainingWidth = document.viewport.getWidth() - 500;
			$('big_images').setWidth(remainingWidth);

			var remainingHeight = document.viewport.getHeight() - 150;
			$('big_images').setHeight(remainingHeight);
			remainingHeightWhiteFrame = remainingHeight - 36; 
			$('leftFrame').setHeight(remainingHeightWhiteFrame);
			$('rightFrame').setHeight(remainingHeightWhiteFrame);
			reloadImages();
				
		}

		function toggleTab(tab)
		{
			Effect.toggle(tab, 'blind', { duration: 0.5 });
		}
	  
		function newTab(tab_title, content, open)
		{
			var tabContainer = new Element('div');
			var tabHeader = new Element('div');
			var tabLine = new Element('div');
			if (Object.isElement(content)) {
				content.parentNode.removeChild(content);
			  tabBody = content;
			} else {
				var tabBody = new Element('div');
				tabBody.id = content;
			}
			if (!open)
				tabBody.hide();

  	  tabHeader.style.backgroundColor = "#dddddd";
  	  tabHeader.style.cursor = "pointer";
			tabHeader.observe('click', function(){
				  toggleTab(tabBody);
				}
			);
			foldUpImage  = new Element('img');
			foldDownImage = new Element('img');
			foldUpImage.setAttribute( "src", "{{ BASE_PATH }}media/img/fold_up.gif");
			foldUpImage.setStyle("float:left;margin:2px;");
			foldDownImage.setAttribute( "src", "{{ BASE_PATH }}media/img/fold_down.gif");
		  foldDownImage.setStyle("float:right;margin:2px;");

		  tabHeader.insert(foldUpImage);
		  tabHeader.insert(foldDownImage);
			tabHeader.innerHTML += "<b>"+tab_title+"</b>";

			tabLine.style.height = "2px";
			tabLine.style.backgroundImage = "url('{{ BASE_PATH }}media/img/bar_middle.jpg')";
			tabLine.style.backgroundRepeat = "repeat-x";
			tabLine.innerHTML = "<img src=\"{{ BASE_PATH }}media/img/bar_left.jpg\" style=\"float:left;\" />"+
			                    "<img src=\"{{ BASE_PATH }}media/img/bar_right.jpg\" style=\"float:right;\" />";
			
			// Return the three div's
			tabContainer.insert(tabHeader);
			tabContainer.insert(tabLine);
			tabContainer.insert(tabBody);
			return tabContainer;
		}
	  
		function getProjectImages()
		{
			var url = '{{ BASE_PATH }}JSON/projectImages/{{id}}?time='+new Date().getTime();
			// notice the use of a proxy to circumvent the Same Origin Policy
			new Ajax.Request(url, {
			  method: 'get',
			  onSuccess: function(transport, json) {
				  
			    var json = transport.responseText.evalJSON();
			    
			    //$('pictureContainerHeader').update('Pictures('+json.length+')');
			     
			    $('tab_pictures').update();
			     
			    // Create a picture container for each picture
			    for(i=0; i < json.length; i++)
						makePictureContainer(json[i]);
					// Put bar in Pictures
					var toolbar = new Element('div');
					toolbar.setStyle("clear:both;float:right;");
					var addLink = new Element('a',{'href':'#'});

					var addImage = new Element('img',{'src':'{{ BASE_PATH }}media/img/add.jpg','id':'addPictureButton','class':'smallPictureButton'});
					addLink.insert(addImage);
					toolbar.insert(addLink);
					Event.observe(addLink,'click',function(){
						popupIFrame('{{BASE_PATH}}fileupload/{{ id }}',350,200);
					});
					//toolbar.innerHTML =  "<a href=\"../fileupload/{{ id }}\"><img border=\"0\" src=\"{{ BASE_PATH }}media/img/add.jpg\" /></a>";
					//toolbar.innerHTML += "<a href=\"../fileupload/{{ id }}\"><img border=\"0\" src=\"{{ BASE_PATH }}media/img/delete.jpg\" /></a>";
					//toolbar.innerHTML += "<a href=\"../fileupload/{{ id }}\"><img border=\"0\" src=\"{{ BASE_PATH }}media/img/camera.jpg\" /></a>";
					$('tab_pictures').insert(toolbar);
				}
			});
		}

		function getProjectTags()
		{
			var url = '{{ BASE_PATH }}JSON/projectTags/{{id}}?time='+new Date().getTime();
			new Ajax.Request(url, {
			  method: 'get',
			  onSuccess: function(transport, json) {
				  
			    var json = transport.responseText.evalJSON();
			    			     
			    $('tags').update();
			     
			    // Create a picture container for each picture
			    for(i=0; i < json.length; i++)
						$('tags').insert(new Element('p').update(json[i].fields.name));
				}
			});
		}

    function getProjectPotentialMeasurements()
    {
      var url = '{{ BASE_PATH }}JSON/projectPotentialMeasurements/{{id}}?time='+new Date().getTime();
      new Ajax.Request(url, {
        method: 'get',
        onSuccess: function(transport, json) {

          var json = transport.responseText.evalJSON();

          $('possiblemeasurements').update();

          // Create a picture container for each picture
          for(i=0; i < json.length; i++){
            var pmmContainerDiv = new Element('div');
            var pmmPointerIMG = new Element('img',{'src':'{{BASE_PATH}}media/img/pin_blue.gif','id':('mm'+json[i].pk),'class':'mmPointer'});
           	pmmContainerDiv.insert(pmmPointerIMG);
						var json = json;
            
          	var pmmTextDiv = new Element('div',{'class':'mmText'}).update(json[i].fields.name);
          	pmmContainerDiv.insert(pmmTextDiv);
            //style must be declared here, else prototype cannot handle it
            var pmmTooltipDiv = new Element('div').update(json[i].fields.name);
            pmmTooltipDiv.setStyle('display:none; position: fixed; z-index: 1000;');
            pmmContainerDiv.insert(pmmTooltipDiv);
            
            $('possiblemeasurements').insert(pmmContainerDiv);

            new Draggable('mm'+json[i].pk, { onEnd: function(element,event) {
						  if($('MouseX').value != '' && $('MouseY').value != '') { LoadMMDD(event.target.id.slice(2), addedImages[0].id) } 
							}
						});
            
            pmmPointerIMG.observe('mouseover', showLandmarkTooltip);
            pmmPointerIMG.observe('mouseout', hideLandmarkTooltip);
          }
        }
      });
    }

		
		function makePictureContainer(pictureJSON)
		{
			var mainDiv = new Element('div', {"id":"mainDiv_"+pictureJSON.pk});
			     mainDiv.addClassName('projectPictureDiv');
			var leftDiv = new Element('div', {"id":"leftDiv"+pictureJSON.pk});
					 leftDiv.addClassName('pictureContainerLeftDiv');
			var rightDiv = new Element('div', {"id":"rightDiv"+pictureJSON.pk});
			    rightDiv.addClassName('pictureContainerRightDiv');
			var bottomDiv = new Element('div', {"id":"bottomDiv"+pictureJSON.pk});
			    bottomDiv.addClassName('pictureContainerBottomDiv');
			
			leftDiv.insert(new Element('img',{'src': base_path+'imageLoader/thumbnail/50/'+pictureJSON.pk}));
			rightDiv.insert(new Element('span').update(pictureJSON.fields.name).addClassName('projectPictureInfo'));
			rightDiv.insert(new Element('span').update(pictureJSON.fields.added).addClassName('projectPictureInfo'));
			
			if(pictureJSON.fields.isLeft)
			  rightDiv.insert(new Element('span').update('Left').addClassName('projectPictureInfo'));
			else
			 rightDiv.insert(new Element('span').update('Right').addClassName('projectPictureInfo'));
			
      var useLink = new Element('a',{'href':'#'}).update('Use ');
			rightDiv.insert(useLink);
			var paintoverLink = new Element('a',{'href':'#'}).update(' Paintover');
			rightDiv.insert(paintoverLink);
			$('tab_pictures').insert(mainDiv);
			useLink.observe('click', function(){
				 	showImage(pictureJSON.pk,pictureJSON.fields.name);
				}
			);
			paintoverLink.observe('click', function(){
					loadEditScreen(pictureJSON.pk,pictureJSON.fields.name);
				}
			);
			mainDiv.insert(leftDiv);
			mainDiv.insert(rightDiv);
			mainDiv.insert(bottomDiv);
		}

		function closePopupAndReloadPictures(){
			getProjectImages();
			new Effect.Highlight('tab_pictures');
			//$('tab_pictures').scrollTo($('addPictureButton'));
			closePopup();	
		}

		function closePopupAndReloadTags(){
			getProjectTags();
			new Effect.Highlight('tags');
			closePopup();	
		}
    
    function closePopupAndReloadCurrentMeasurements(){
      //$('currentmeasurements').update();
      img = addedImages[0]
      getImageMeasurements(img.id);
      new Effect.Highlight('bottomDiv'+img.id);
    }                                                      

		function closePopupAndReloadPotentialMeasurements(){
      getProjectPotentialMeasurements();
      new Effect.Highlight('tab_measurements');
      closePopup();
    }

		function showImage(id,name){
			var newAddedImage = new AddedImage(id,name);
			var newImageArray = new Array();
			//Delete the old image and put it up front
			for(i = 0; i < addedImages.length; i++){
				if(addedImages[i].id != id){
					newImageArray.push(addedImages[i]);
				}
			}
			addedImages = newImageArray
			addedImages.splice(0,0,newAddedImage);
			
			
			id_array = Sortable.sequence("tab_pictures");
			var temp = "";
			for(var i = 0; i < id_array.length; i++){
        if(id_array[i] == id){
          temp = id_array[i];
          id_array.splice(i,1);
          break;
        }
      }
      id_array.splice(0,0,temp);
			Sortable.setSequence("tab_pictures",id_array);
			reloadImages();
		}

		function loadEditScreen(id,name){
			img_url = '{{BASE_PATH}}imageLoader/'+id;
			mov_width = ($('big_images').getWidth()-5);
			mov_heigth = ($('big_images').getHeight()-5);
				
			movie_object = new Element('object');
			movie_object.writeAttribute('classid', "clsid:d27cdb6e-ae6d-11cf-96b8-444553540000");
			movie_object.writeAttribute('codebase',"http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=8,0,0,0");
			movie_object.writeAttribute('width', mov_width);
			movie_object.writeAttribute('height', mov_heigth);

			movie_embed = new Element('embed');
			movie_embed.writeAttribute('src',"{{ BASE_PATH }}media/flash/paint.swf");
			movie_embed.writeAttribute('quality',"high");
			movie_embed.writeAttribute('bgcolor',"#000000");
			movie_embed.writeAttribute('width', mov_width);
			movie_embed.writeAttribute('height', mov_heigth);
			movie_embed.writeAttribute('allowScriptAccess',"sameDomain");
			movie_embed.writeAttribute('type',"application/x-shockwave-flash");
			movie_embed.writeAttribute('pluginspage',"http://www.macromedia.com/go/getflashplayer");
			movie_embed.writeAttribute('flashvars',"img_source="+img_url);

			movie_object.insert(movie_embed);
			$('big_images').update();
			$('big_images').insert(movie_object);
		}

		function hideImage(id){
		  //clear the data of this image
      $('bottomDiv'+id).update();
			$('mainDiv_'+id).setStyle('border: none;');
      			
      var newImageArray = new Array();
			//Delete the old image and copy the rest
			for(i = 0; i< addedImages.length; i++){
				if(addedImages[i].id != id){
					newImageArray.push(addedImages[i]);
				}
			}
			addedImages = newImageArray;
			reloadImages();
		}
		
		function reloadImages(){
			//.update() clears the contents of the elements
      $('big_images').update();
			for(var i = addedImages.length-1; i >= 0; i--){
  			$('bottomDiv'+addedImages[i].id).update();
				$('mainDiv_'+addedImages[i].id).setStyle('border: none;');
        addedImages[i].addSelfToImages();
			}
			
			if (addedImages.length > 0){
        $('mainDiv_'+addedImages[0].id).setStyle('border: 1px dashed red;');        
      }
      Sortable.create("tab_pictures", {tag: 'div', only: 'projectPictureDiv', onUpdate: updateImageList });			
		}
		
		function updateImageList(){
      id_array = Sortable.sequence("tab_pictures");
      new_list = new Array();
      for(var i = 0; i < id_array.length; i++){
        for(var j = 0; j < addedImages.length; j++){
          if(id_array[i] == addedImages[j].id){
            new_list.push(addedImages[j]);
            break;
          }
        }
      }
      addedImages = new_list;
      reloadImages();
    }
  </script>

{% endblock head %}

{% block body %}
<div id="popup"></div>
<div id="leftFrame" class="whiteFrame_container" style="float:left;position:absolute;top:105px;left:5px;">

	<!-- Top white frame -->
	<div class="whiteFrame_top_container">
		<div class="whiteFrame_top_left"></div>
		<div id="leftFrameHandle" class="whiteFrame_top_middle" style="color:grey;text-align: center;line-height: 20px ;font-size: 8pt;">View</div>
		<div class="whiteFrame_top_right"></div>
	</div>

	<div class="whiteFrame_center_container">

		<!-- Left white frame -->
		<div class="whiteFrame_center_left"></div>

		<!-- Content white frame -->
		<div class="whiteFrame_center_middle">
		  <div id="leftFrame_content"></div>
		</div>

		<!-- Right white frame -->
		<div class="whiteFrame_center_right"></div>

	</div>

	<!-- Bottom white frame -->
	<div class="whiteFrame_bottom_container">
		<div class="whiteFrame_bottom_left"></div>
		<div class="whiteFrame_bottom_center"></div>
		<div class="whiteFrame_bottom_right"></div>
	</div>
</div>


<div id="big_images" style="margin:auto;width:700px;height:400px;border:dashed 1px yellow;"></div>

<div id="rightFrame" class="whiteFrame_container" style="float:left;position:absolute;top:105px;right:5px;">

	<!-- Top white frame -->
	<div class="whiteFrame_top_container">
		<div class="whiteFrame_top_left"></div>
		<div id="rightFrameHandle" class="whiteFrame_top_middle" style="color:grey;text-align: center;line-height: 20px ;font-size: 8pt;">Edit</div>
		<div class="whiteFrame_top_right"></div>
	</div>

	<div class="whiteFrame_center_container">

		<!-- Left white frame -->
		<div class="whiteFrame_center_left"></div>

		<!-- Content white frame -->
		<div class="whiteFrame_center_middle">
		  <div id="rightFrame_content"></div>
		</div>

		<!-- Right white frame -->
		<div class="whiteFrame_center_right"></div>

	</div>

	<!-- Bottom white frame -->
	<div class="whiteFrame_bottom_container">
		<div class="whiteFrame_bottom_left"></div>
		<div class="whiteFrame_bottom_center"></div>
		<div class="whiteFrame_bottom_right"></div>
	</div>
</div>

<!-- TABS -->

<div id="tab_projectinfo" class="tabContent">
  <b>{{ project }}</b><br>
	<p>{{ project.description }}</p>
	<b>Tags</b>
	<a href="#" id='editTagsLink' style="float:right;clear:both;"><img src="{{BASE_PATH}}media/img/pencil.jpg" style="border:0px;" /></a>
	<div id="tags">

	</div>
</div>
<div id="tab_pictures" class="tabContent"></div>
<div id="tab_papers" class="tabContent">
  {% include 'annotation/list.html' %}<br>
  <a href="{{ BASE_PATH }}annotation/new/{{ id }}" style="float:right;clear:both;" target="_blank"><img src="{{BASE_PATH}}media/img/add.jpg" style="border:0px;" /></a>
</div>
<div id="tab_measurements" class="tabContent">
  <a id="addMeasurementLink" style="float:right;clear:both;" target="_blank"><img src="{{BASE_PATH}}media/img/add.jpg" style="border:0px;" /></a>
  <div id="possiblemeasurements">

	</div>
</div>
<div id="tab_attributes" class="tabContent">
	<table style="width:200px">
		<tr><th>Coordinates</th></tr>
		<tr><td><input type="text" id="MouseX" value="0" size="4"> X<br />
		<input type="text" id="MouseY" value="0" size="4"> Y</td></tr>
		<tr><th>Results</th></tr>
		<tr><td id="ajax_result"></td></tr>
	</table>
</div>


<!-- POPUP -->
  
<div id="lmdd" style="display: none; position: absolute; background-color: white; color: black; padding: 5px;">
	<div style="background-color: #ccc;">Store Landmark</div>
	<label for="mmx">x: </label><input type="text" style="width: 25px;" id="lmmx" name="mmx" value="" />
	<label for="mmy">y: </label><input type="text" style="width: 25px;" id="lmmy" name="mmy" value="" /><br />
	<label id="labelmmmeting" for="mmmeting">Landmark: </label><select id="mmmeting" name="mmmeting">
	<option value=""></option>
		{%for mm in mmetings%}
			<option id="option{{mm.id}}" value="{{mm.id}}">{{mm.name}}</option>
		{% endfor %}
	</select><br />
  <input type="hidden" id="imgid" value="" />
	<button onClick="saveLandMark();">Store</button>
</div>

{% endblock body %}